var LoadGLBFromMessage=pc.createScript("loadGLBFromMessage");LoadGLBFromMessage.initialize=null,LoadGLBFromMessage.prototype.initialize=function(){function addMessageListener(){window.vuplex.addEventListener("message",(e=>{let o=e.data;console.log("JSON received: "+o),LoadGLBFromMessage.initialize.load(o)}))}console.log("Init6"),LoadGLBFromMessage.initialize=this,window.vuplex?addMessageListener():window.addEventListener("vuplexready",addMessageListener)},LoadGLBFromMessage.prototype.load=function(e){var o=this.app;pc.http.get(e,{responseType:"arraybuffer"},(function(e,a){if(e)console.error("Ошибка загрузки GLB:",e);else{var i=new Blob([a],{type:"model/gltf-binary"}),s=URL.createObjectURL(i);o.assets.loadFromUrl(s,"container",(function(e,a){if(e)console.error("Ошибка загрузки контейнера:",e);else{var i=a.resource.instantiateRenderEntity();i.setLocalPosition(0,0,0),o.root.addChild(i)}}))}}))};var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("target",{type:"entity",title:"Target"}),OrbitCamera.attributes.add("distance",{type:"number",default:5,title:"Distance from Target"}),OrbitCamera.attributes.add("minDistance",{type:"number",default:2,title:"Min Distance"}),OrbitCamera.attributes.add("maxDistance",{type:"number",default:15,title:"Max Distance"}),OrbitCamera.attributes.add("sensitivity",{type:"number",default:.3,title:"Mouse Sensitivity"}),OrbitCamera.attributes.add("zoomSensitivity",{type:"number",default:1,title:"Zoom Sensitivity"}),OrbitCamera.prototype.initialize=function(){this.yaw=0,this.pitch=0,this.isMouseDown=!1,this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)},OrbitCamera.prototype.onMouseDown=function(t){t.button===pc.MOUSEBUTTON_LEFT&&(this.isMouseDown=!0)},OrbitCamera.prototype.onMouseUp=function(t){t.button===pc.MOUSEBUTTON_LEFT&&(this.isMouseDown=!1)},OrbitCamera.prototype.onMouseMove=function(t){this.isMouseDown&&(this.yaw-=t.dx*this.sensitivity,this.pitch-=t.dy*this.sensitivity,this.pitch=pc.math.clamp(this.pitch,-89,89))},OrbitCamera.prototype.onMouseWheel=function(t){this.distance-=t.wheel*this.zoomSensitivity*.1,this.distance=pc.math.clamp(this.distance,this.minDistance,this.maxDistance)},OrbitCamera.prototype.update=function(t){if(this.target){var i=new pc.Quat;i.setFromEulerAngles(this.pitch,this.yaw,0);var e=new pc.Vec3;e.copy(this.target.getPosition());var s=new pc.Vec3(0,0,this.distance);i.transformVector(s,s),e.add(s),this.entity.setPosition(e),this.entity.lookAt(this.target.getPosition())}};var Rotate360=pc.createScript("rotate360");Rotate360.attributes.add("target",{type:"entity"}),Rotate360.attributes.add("radius",{type:"number",default:5}),Rotate360.attributes.add("rotationSpeed",{type:"number",default:30}),Rotate360.attributes.add("minRadius",{type:"number",default:2}),Rotate360.attributes.add("maxRadius",{type:"number",default:10}),Rotate360.attributes.add("zoomSpeed",{type:"number",default:1}),Rotate360.prototype.initialize=function(){this.angle=0,this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)},Rotate360.prototype.update=function(t){if(this.target){this.angle+=pc.math.DEG_TO_RAD*this.rotationSpeed*t;var e=this.target.getPosition(),a=e.x+this.radius*Math.sin(this.angle),i=e.z+this.radius*Math.cos(this.angle),o=e.y+2;this.entity.setPosition(a,o,i),this.entity.lookAt(e)}},Rotate360.prototype.onMouseWheel=function(t){this.radius-=t.wheel*this.zoomSpeed*.1,this.radius=pc.math.clamp(this.radius,this.minRadius,this.maxRadius),t.event.preventDefault()},Rotate360.prototype.destroy=function(){this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)};